<% content_for(:title, "#{@picture.caption.presence || 'Picture'} by #{@picture.user.username} (#{@picture.token})") %>

<div class="row">
  <div class="col-md-8">
    <nav aria-label="picture pagination">
      <ul class="pagination pagination-sm justify-content-center">
        <% if @previous_picture %>
          <li class="page-item">
            <%= link_to picture_path(@previous_picture, from: @show_picture_from, order: @show_picture_order), class: 'page-link', aria_label: 'previous' do %>
              <i class="fa fa-chevron-left" aria-hidden="true"></i>
              <span class="sr-only">Previous</span>
            <% end %>
          </li>
        <% else %>
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1" aria-label="previous">
              <i class="fa fa-chevron-left" aria-hidden="true"></i>
              <span class="sr-only">Previous</span>
            </a>
          </li>
        <% end %>
        <% if @next_picture %>
          <li class="page-item">
            <%= link_to picture_path(@next_picture, from: @show_picture_from, order: @show_picture_order), class: 'page-link', aria_label: 'next' do %>
              <i class="fa fa-chevron-right" aria-hidden="true"></i>
              <span class="sr-only">Next</span>
            <% end %>
          </li>
        <% else %>
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1" aria-label="next">
              <i class="fa fa-chevron-right" aria-hidden="true"></i>
              <span class="sr-only">Next</span>
            </a>
          </li>
        <% end %>
      </ul>
    </nav>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <figure class="figure mx-auto d-block">
      <%= image_tag(@picture.image_url(:large).to_s, class: 'figure-img img-fluid mx-auto d-block', style: 'max-height:75vh') %>
      <figcaption class="figure-caption text-center"><%= @picture.caption %></figcaption>
    </figure>
  </div>

  <div class="col-md-4">
    <p>
      Published <%= timeago_tag @picture.created_at, :limit => 10.days.ago %>
      by <strong><%= link_to @picture.user.username, user_path(@picture.user) %></strong>
    </p>

    <p>
      <%= pluralize(@picture.get_likes.size, 'like') %>,
      <%= pluralize(@picture.views_count, 'view') %>
      <span class="text-muted">(<%= number_to_human_size(@picture.views_count * @picture.image.size) %>)</span>
    </p>

    <% if user_signed_in? && current_user.liked?(@picture) %>
      <%= link_to unlike_picture_path(@picture), method: :put, class: 'btn btn-secondary', role: 'button' do %>
        <i class="fa fa-heart" aria-hidden="true"></i> Unlike
      <% end %>
    <% else %>
      <%= link_to like_picture_path(@picture), method: :put, class: 'btn btn-secondary', role: 'button' do %>
        <i class="fa fa-heart" aria-hidden="true"></i> Like
      <% end %>
    <% end %>

    <% if user_signed_in? && @picture.user_id == current_user.id %>
      <%= link_to edit_picture_path(@picture), class: 'btn btn-secondary', role: 'button' do %>
        <i class="fa fa-pencil" aria-hidden="true"></i> Edit
      <% end %>
    <% end %>
  </div>
</div>
